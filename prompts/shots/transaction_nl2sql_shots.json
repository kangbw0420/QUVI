[
  {
    "질문": "대한전자 거래 내역 중 가장 최신 것만 보여줘",
    "SQL": "FROM bank_transactions WHERE NOTE1 ILIKE '%대한전자%' ORDER BY TRSC_DT desc LIMIT 1"
  },
  {
    "질문": "1억 원 이상 출금된 거래 내역을 찾아줘",
    "SQL": "FROM bank_transactions WHERE TRSC_AMT >= 100000000 AND IN_OUT_DV = 2"
  },
  {
    "질문": "고정입금내역 보여줘",
    "SQL": "SELECT ACCT_NO, NOTE1, COUNT(DISTINCT DATE_TRUNC('month', TRSC_DT)) as \"months_count\", ROUND(AVG(TRSC_AMT), 2) as \"avg_amount\", ROUND(AVG(EXTRACT('day' FROM TRSC_DT))) as \"typical_day\" FROM bank_transactions WHERE IN_OUT_DV = '1' GROUP BY ACCT_NO, NOTE1 HAVING COUNT(DISTINCT DATE_TRUNC('month', TRSC_DT)) >= 3 AND stddev(TRSC_AMT) < AVG(TRSC_AMT) * 0.1 AND stddev(EXTRACT('day' FROM TRSC_DT)) <= 5 ORDER BY avg_amount DESC"
  },
  {
    "질문": "월평균 순현금흐름 보여줘",
    "SQL": "WITH monthly_pl AS (SELECT DATE_TRUNC('month', TRSC_DT) as \"month\", sum(CASE WHEN IN_OUT_DV = '1' THEN TRSC_AMT ELSE -TRSC_AMT END) as \"net_amount\" FROM bank_transactions GROUP BY DATE_TRUNC('month', TRSC_DT)) SELECT AVG(net_amount) as '평균 순현금흐름' FROM monthly_pl"
  },
  {
    "질문": "11월 1일 거래 내역",
    "SQL": "From bank_transactions WHERE TRSC_DT = '2024-11-01'"
  },
  {
    "질문": "총 사용금액을 계산해줘",
    "SQL": "SELECT SUM(TRSC_AMT) FROM bank_transactions WHERE IN_OUT_DV = 2"
  },
  {
    "질문": "적요에 '지방세'가 들어간 거래 내역을 찾아줘",
    "SQL": "FROM bank_transactions WHERE NOTE1 ILIKE '%지방세%'"
  },
  {
    "질문": "최대 거래액과 해당 거래의 적요를 보여줘",
    "SQL": "SELECT TRSC_AMT, NOTE1 FROM bank_transactions ORDER BY TRSC_AMT DESC LIMIT 1"
  },
  {
    "질문": "세 번째로 큰 거래 금액과 해당 거래의 세부 정보를 찾아줘",
    "SQL": "SELECT TRSC_AMT, NOTE1 FROM bank_transactions ORDER BY TRSC_AMT DESC LIMIT 1 OFFSET 2"
  },
  {
    "질문": "대한전자에서 들어온 돈 금액과 건수는",
    "SQL": "FROM bank_transactions WHERE NOTE1 ILIKE '%대한전자%' ORDER BY TRSC_DT desc"
  },
  {
    "질문": "적요가 대한전자인 거래 내역들의 월별 입금 합계를 계산해줘",
    "SQL": "SELECT SUM(TRSC_AMT) FROM bank_transactions WHERE NOTE1 ILIKE '%대한전자%' GROUP BY DATE_TRUNC('month', TRSC_DT)"
  },
  {
    "질문": "가장 많이 나타난 적요가 뭐야?",
    "SQL": "FROM bank_transactions WHERE NOTE1 = (SELECT NOTE1 FROM bank_transactions GROUP BY NOTE1 ORDER BY COUNT(*) DESC LIMIT 1)"
  },
  {
    "질문": "2023년 총 매출액을 계산해줘",
    "SQL": "SELECT SUM(TRSC_AMT) FROM bank_transactions WHERE TRSC_DT >= '2023-01-01'  AND TRSC_DT < '2024-01-01' AND IN_OUT_DV = 2"
  },
  {
    "질문": "기업은행 수시입출계좌 거래 내역",
    "SQL": "SELECT * FROM bank_transactions WHERE BANK_NM = '기업은행"
  },
  {
    "질문": "출금 내역만 보여줘",
    "SQL": "SELECT * FROM bank_transactions WHERE IN_OUT_DV = 2"
  },
  {
    "질문": "농협 계좌에서 3억 원 이상 출금된 거래 내역을 보여줘",
    "SQL": "SELECT * WHERE BANK_NM = '농협' AND TRSC_AMT >= 300000000 AND IN_OUT_DV = 2"
  },
  {
    "질문": "매월 첫째 주 월요일에 이뤄진 거래를 나열해 줘",
    "SQL": "SELECT * FROM bank_transactions WHERE EXTRACT(DOW FROM TRSC_DT) = 1 AND TRSC_DT BETWEEN DATE_TRUNC('month', TRSC_DT) AND DATE_TRUNC('month', TRSC_DT) + INTERVAL '6 days'"
  },
  {
    "질문": "거래 내역 중 적요가 마드라스체크인 것만 보여줘",
    "SQL": "SELECT * FROM bank_transactions WHERE NOTE1 ILIKE '%마드라스체크%'"
  },
  {
    "질문": "200만 원에서 500만 원 사이의 거래를 나열해줘",
    "SQL": "SELECT * FROM bank_transactions WHERE TRSC_AMT BETWEEN 2000000 AND 5000000"
  },
  {
    "질문": "2024년 6월 20일의 입금과 출금 거래를 비교해줘",
    "SQL": "SELECT SUM(CASE WHEN IN_OUT_DV = 1 THEN TRSC_AMT ELSE 0 END) AS 입금_금액, SUM(CASE WHEN IN_OUT_DV = 2 THEN TRSC_AMT ELSE 0 END) AS 출금_금액 FROM bank_transactions WHERE TRSC_DT = '2024-06-20'"
  }
]
